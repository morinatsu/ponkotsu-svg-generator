# リファクタリング提案2：ドラッグ操作のパフォーマンス最適化

## 目的

図形のドラッグ操作中の再描画処理をなくすことで、アプリケーションのパフォーマンスを向上させます。
これにより、図形の数が数百、数千個に増えた場合でも、滑らかで快適なユーザー体験（UX）を維持します。

## 現状の問題点

現在、ドラッグ中にマウスが動くたびに `DRAG_SHAPE` アクションが `dispatch` されています。
`reducer` はこのアクションを受け取るたびに、`shapes` 配列全体を新しい配列として作り直しており、これがReactの再描画（re-render）を引き起こします。
図形の数が少ないうちは問題ありませんが、数が増えるとこの処理がボトルネックとなり、ドラッグ操作がカクつく原因となります。

## 具体的なステップ

1.  **`DRAG_SHAPE` アクションの廃止**
    - `reducer.ts` から `DRAG_SHAPE` アクションに関連するコードを削除します。マウス移動中に `dispatch` を行わないように変更します。

2.  **CSS `transform` による視覚的な移動**
    - ドラッグ中は、Reactの `state` を更新する代わりに、対象のSVG要素の `transform` スタイルを直接書き換えます。
    - これにより、Reactの再描画を介さずにブラウザが直接要素を移動させるため、非常に高速な描画が可能になります。
    - このDOM操作ロジックは、インタラクションを管理するカスタムフック（例: `useInteractionManager`）内で実装します。

3.  **ドラッグ終了時に `state` を一括更新**
    - マウスが離された瞬間に、最終的な移動先の座標を計算します。
    - `STOP_DRAGGING` アクションを拡張するか、`UPDATE_SHAPE_POSITION` のような新しいアクションを定義し、そのペイロードで `shapeId` と最終座標を `reducer` に伝えます。
    - `reducer` はこのアクションを受け取った時に、一度だけ `shapes` 配列を更新します。
    - 同時に、DOM要素に適用していた `transform` スタイルをリセットします。
