### Julesへの指示書 (v0.4.2 - デバッグモードのコマンドライン対応)

### **プロジェクト名:**

ぽんこつSVGジェネレーター (v0.4.2 - デバッグモードのコマンドライン対応)

### **プロジェクト概要:**

デバッグ機能（アクションロガーと状態ビューア）の有効化を、これまでの `NODE_ENV` による自動判別に加え、**コマンドラインから明示的に指定できる**ように変更します。これにより、通常の開発時とデバッグ時を簡単に切り替えられるようにします。

-----

### **実装ステップの提案:**

Jules、以下のステップで実装を進めてください。

#### 1\. 起動コマンドの追加 (`package.json`)

デバッグモードで開発サーバーを起動するための新しいnpmスクリプトを追加します。このコマンドは、デバッグモードを有効にするための環境変数を設定します。

**`package.json` の `scripts` を以下のように更新してください:**

```json:package.json
"scripts": {
  "dev": "vite",
  "dev:debug": "vite --mode debug", // この行を追加
  "build": "tsc -b && vite build",
  // ... (他のスクリプト)
},
```

  * `vite --mode debug` とすることで、Viteは `.env.debug` という名前のファイルを読み込むようになります。

#### 2\. デバッグモード用の環境変数ファイルを作成

プロジェクトのルートに `.env.debug` という名前で新しいファイルを作成し、デバッグ機能を有効にするための変数を定義します。

**`.env.debug` (新規作成):**

```
VITE_DEBUG_MODE=true
```

#### 3\. デバッグ機能の有効化条件を変更

`logger` の適用と `DebugInfo` コンポーネントの表示条件を、`process.env.NODE_ENV` から新しい環境変数 `import.meta.env.VITE_DEBUG_MODE` を見るように変更します。

**`App.tsx` の修正:**

```typescript:src/app.tsx
// ... (import文)

const undoableReducer = undoable(reducer);
// デバッグモードが有効な場合のみロガーを適用
const rootReducer = import.meta.env.VITE_DEBUG_MODE === 'true'
    ? logger(undoableReducer)
    : undoableReducer;

function App() {
    // ...
}
```

**`DebugInfo.tsx` の修正:**

```tsx:src/components/debuginfo.tsx
// ...

const DebugInfo: React.FC<DebugInfoProps> = ({ history }) => {
  // VITE_DEBUG_MODEが'true'でない場合は何もレンダリングしない
  if (import.meta.env.VITE_DEBUG_MODE !== 'true') {
    return null;
  }

  // ... (以降のコードは変更なし)
};
```

-----

### 使い方

以上の修正により、開発サーバーの起動方法でデバッグ機能のON/OFFを切り替えられるようになります。

  * **通常モードで起動（デバッグ機能OFF）:**

    ```bash
    pnpm run dev
    ```

  * **デバッグモードで起動（ログ出力と状態ビューアON）:**

    ```bash
    pnpm run dev:debug
    ```

この方法は、Viteの標準的な機能を利用しているため、シンプルでメンテナンスしやすいのでおすすめです。